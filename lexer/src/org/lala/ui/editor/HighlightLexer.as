package org.lala.ui.editor
{
    ;

    public class HighlightLexer
    {
        protected var _transTable:Array;
        protected var _finalTable:Object;
        protected var _inputTable:Array;
        protected var _initialTable:Object;
        protected const DEADSTATE:uint = uint.MAX_VALUE;
        
        protected var _start:uint;
        protected var _oldStart:uint;
        protected var _tokenName:String;
        protected var _yytext:*;
        protected var _yy:Object;
        protected var _ended:Boolean;
        protected var _initialInput:Number;
        protected var _initialState:String;
        
        protected var _line:uint;
        protected var _col:uint;
        protected var _advanced:Boolean;
        
        protected var _source:String;
        ;

        public function HighlightLexer()
        {
            _transTable = 
[[false,[4294967295,11,10,9,7,6,5,4,3,2,1,8],[[0,41,0],[42,42,1],[43,43,2],[44,44,3],[45,45,4],[46,46,5],[47,47,6],[48,48,7],[49,49,8],[50,50,9],[51,51,10],[52,52,11]]],[false,[4294967295,15,14,13,12,21,20,19,18,17,16],[[0,11,0],[12,12,1],[13,31,2],[32,32,3],[33,33,4],[34,34,5],[35,35,6],[36,36,7],[37,39,8],[40,40,9],[41,41,10],[42,52,0]]],[false,[4294967295,14,13,22,21,18,17],[[0,12,0],[13,31,1],[32,32,2],[33,33,3],[34,34,4],[35,36,0],[37,39,5],[40,40,6],[41,52,0]]],[false,[4294967295,23,21,26,25,24],[[0,32,0],[33,33,1],[34,34,2],[35,36,0],[37,37,3],[38,38,4],[39,39,5],[40,52,0]]],[false,[4294967295,27,21,26,25,24],[[0,10,0],[11,11,1],[12,12,0],[13,31,1],[32,33,0],[34,34,2],[35,36,0],[37,37,3],[38,38,4],[39,39,5],[40,52,0]]],[false,[30,36,28,32,29,35,34,33,24,31,4294967295],[[0,0,0],[1,1,1],[2,9,2],[10,10,3],[11,31,2],[32,32,4],[33,33,2],[34,34,5],[35,36,2],[37,37,6],[38,38,7],[39,39,8],[40,40,9],[41,41,2],[42,52,10]]],[false,[4294967295,38,37,27,21,24],[[0,7,0],[8,8,1],[9,9,2],[10,10,0],[11,11,3],[12,12,0],[13,31,3],[32,33,0],[34,34,4],[35,38,0],[39,39,5],[40,52,0]]],[false,[4294967295,21,34,33,39],[[0,33,0],[34,34,1],[35,36,0],[37,37,2],[38,38,3],[39,39,4],[40,52,0]]],[false,[42,45,40,41,44,4294967295,43],[[0,0,0],[1,1,1],[2,31,2],[32,32,3],[33,33,2],[34,34,4],[35,36,2],[37,39,5],[40,40,6],[41,41,2],[42,52,5]]],[false,[4294967295,21,34,33,46],[[0,33,0],[34,34,1],[35,36,0],[37,37,2],[38,38,3],[39,39,4],[40,52,0]]],[false,[48,47,50,49,34,33,4294967295],[[0,32,0],[33,33,1],[34,34,2],[35,35,3],[36,36,0],[37,37,4],[38,38,5],[39,41,0],[42,52,6]]],[false,[51,53,54,52,4294967295],[[0,6,0],[7,7,1],[8,33,0],[34,34,2],[35,35,3],[36,41,0],[42,52,4]]],[false,[4294967295,60,59,58,57,56,55],[[0,26,0],[27,27,1],[28,28,2],[29,29,3],[30,30,4],[31,31,5],[32,32,0],[33,33,6],[34,52,0]]],[false,[61,4294967295],[[0,31,0],[32,32,1],[33,41,0],[42,52,1]]],[false,[4294967295,14],[[0,4,0],[5,6,1],[7,10,0],[11,11,1],[12,12,0],[13,31,1],[32,52,0]]],[true],[true],[false,[62,4294967295],[[0,39,0],[40,40,1],[41,41,0],[42,52,1]]],[false,[4294967295,18],[[0,36,0],[37,39,1],[40,52,0]]],[true],[true],[false,[4294967295,63],[[0,8,0],[9,9,1],[10,52,0]]],[false,[4294967295,59,58,57,56,55],[[0,27,0],[28,28,1],[29,29,2],[30,30,3],[31,31,4],[32,32,0],[33,33,5],[34,52,0]]],[false,[4294967295,65,64],[[0,5,0],[6,6,1],[7,12,0],[13,31,1],[32,32,0],[33,33,2],[34,52,0]]],[false,[4294967295,24],[[0,38,0],[39,39,1],[40,52,0]]],[false,[4294967295,26],[[0,36,0],[37,37,1],[38,52,0]]],[true],[false,[4294967295,27],[[0,3,0],[4,6,1],[7,8,0],[9,9,1],[10,10,0],[11,11,1],[12,12,0],[13,31,1],[32,52,0]]],[false,[30,36,28,4294967295],[[0,0,0],[1,1,1],[2,36,2],[37,39,3],[40,41,2],[42,52,3]]],[false,[67,69,29,66,68,4294967295],[[0,0,0],[1,1,1],[2,31,2],[32,32,3],[33,36,2],[37,39,4],[40,41,2],[42,52,5]]],[false,[28,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,1]]],[false,[70,72,31,71,66,4294967295],[[0,0,0],[1,1,1],[2,36,2],[37,39,3],[40,40,4],[41,41,2],[42,52,5]]],[false,[4294967295,73],[[0,9,0],[10,10,1],[11,52,0]]],[false,[4294967295,34],[[0,36,0],[37,37,1],[38,52,0]]],[true],[false,[30,36,28,75,74,4294967295],[[0,0,0],[1,1,1],[2,8,2],[9,9,3],[10,30,2],[31,31,4],[32,36,2],[37,39,5],[40,41,2],[42,52,5]]],[false,[76,36,28,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,36,1],[37,38,3],[39,41,1],[42,52,3]]],[true],[true],[false,[4294967295,39],[[0,38,0],[39,39,1],[40,52,0]]],[false,[42,45,40,4294967295],[[0,0,0],[1,1,1],[2,36,2],[37,39,3],[40,41,2],[42,52,3]]],[false,[78,79,41,77,68,4294967295],[[0,0,0],[1,1,1],[2,31,2],[32,32,3],[33,36,2],[37,39,4],[40,41,2],[42,52,5]]],[false,[40,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,1]]],[false,[80,81,43,71,77,4294967295],[[0,0,0],[1,1,1],[2,36,2],[37,39,3],[40,40,4],[41,41,2],[42,52,5]]],[false,[42,45,40,82,4294967295],[[0,0,0],[1,1,1],[2,8,2],[9,9,3],[10,36,2],[37,39,4],[40,41,2],[42,52,4]]],[false,[83,45,40,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,36,1],[37,38,3],[39,41,1],[42,52,3]]],[false,[4294967295,46],[[0,38,0],[39,39,1],[40,52,0]]],[false,[48,84,4294967295],[[0,34,0],[35,35,1],[36,36,0],[37,38,2],[39,41,0],[42,52,2]]],[false,[48,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,1]]],[false,[49,85,4294967295],[[0,6,0],[7,7,1],[8,36,0],[37,38,2],[39,41,0],[42,52,2]]],[false,[48,86,4294967295],[[0,8,0],[9,9,1],[10,36,0],[37,38,2],[39,41,0],[42,52,2]]],[false,[51,4294967295],[[0,6,0],[7,7,1],[8,34,0],[35,35,1],[36,41,0],[42,52,1]]],[true],[true],[false,[51,4294967295,87],[[0,6,0],[7,7,1],[8,8,0],[9,9,2],[10,34,0],[35,35,1],[36,41,0],[42,52,1]]],[true],[false,[4294967295,88],[[0,25,0],[26,26,1],[27,52,0]]],[false,[4294967295,89],[[0,24,0],[25,25,1],[26,52,0]]],[false,[4294967295,90],[[0,23,0],[24,24,1],[25,52,0]]],[false,[4294967295,91],[[0,22,0],[23,23,1],[24,52,0]]],[false,[4294967295,92],[[0,29,0],[30,30,1],[31,52,0]]],[false,[61,93,4294967295],[[0,31,0],[32,32,1],[33,41,0],[42,52,2]]],[false,[62,93,4294967295],[[0,39,0],[40,40,1],[41,41,0],[42,52,2]]],[false,[63,94,4294967295],[[0,8,0],[9,9,1],[10,41,0],[42,52,2]]],[true],[false,[4294967295,65],[[0,5,0],[6,6,1],[7,12,0],[13,31,1],[32,52,0]]],[false,[30,36,28,4294967295],[[0,0,0],[1,1,1],[2,36,2],[37,39,3],[40,41,2],[42,52,3]]],[false,[29,68,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,2]]],[false,[96,68,95,4294967295],[[0,0,0],[1,31,1],[32,32,2],[33,41,1],[42,52,3]]],[false,[98,69,29,97,68,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,31,1],[32,32,3],[33,36,1],[37,38,4],[39,41,1],[42,52,5]]],[false,[31,71,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,2]]],[false,[99,71,95,4294967295],[[0,0,0],[1,39,1],[40,40,2],[41,41,1],[42,52,3]]],[false,[100,72,31,71,97,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,36,1],[37,38,3],[39,39,1],[40,40,4],[41,41,1],[42,52,5]]],[false,[4294967295,101],[[0,21,0],[22,22,1],[23,52,0]]],[false,[30,36,28,102,4294967295],[[0,0,0],[1,1,1],[2,25,2],[26,26,3],[27,36,2],[37,39,4],[40,41,2],[42,52,4]]],[false,[103,105,75,104,63,4294967295],[[0,0,0],[1,1,1],[2,8,2],[9,9,3],[10,36,2],[37,39,4],[40,41,2],[42,52,5]]],[false,[36,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,1]]],[false,[42,45,40,4294967295],[[0,0,0],[1,1,1],[2,36,2],[37,39,3],[40,41,2],[42,52,3]]],[false,[41,68,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,2]]],[false,[107,79,41,106,68,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,31,1],[32,32,3],[33,36,1],[37,38,4],[39,41,1],[42,52,5]]],[false,[43,71,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,2]]],[false,[108,81,43,71,106,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,36,1],[37,38,3],[39,39,1],[40,40,4],[41,41,1],[42,52,5]]],[false,[109,111,82,110,63,4294967295],[[0,0,0],[1,1,1],[2,8,2],[9,9,3],[10,36,2],[37,39,4],[40,41,2],[42,52,5]]],[false,[45,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,1]]],[false,[84,48,113,112,115,114,4294967295],[[0,6,0],[7,7,1],[8,31,0],[32,32,2],[33,33,3],[34,36,0],[37,38,4],[39,39,0],[40,40,5],[41,41,0],[42,52,6]]],[false,[48,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,1]]],[false,[86,116,63,4294967295],[[0,8,0],[9,9,1],[10,36,0],[37,38,2],[39,41,0],[42,52,3]]],[false,[87,63,117,4294967295],[[0,6,0],[7,7,1],[8,8,0],[9,9,2],[10,34,0],[35,35,1],[36,41,0],[42,52,3]]],[false,[4294967295,119,118],[[0,19,0],[20,20,1],[21,21,2],[22,52,0]]],[false,[4294967295,120],[[0,18,0],[19,19,1],[20,52,0]]],[false,[4294967295,121],[[0,28,0],[29,29,1],[30,52,0]]],[false,[4294967295,122],[[0,17,0],[18,18,1],[19,52,0]]],[false,[4294967295,123],[[0,25,0],[26,26,1],[27,52,0]]],[true],[false,[63,94,124,4294967295],[[0,8,0],[9,9,1],[10,33,0],[34,34,2],[35,41,0],[42,52,3]]],[true],[false,[68,4294967295],[[0,41,0],[42,52,1]]],[false,[76,36,28,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,36,1],[37,38,3],[39,41,1],[42,52,3]]],[false,[69,68,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,2]]],[false,[71,4294967295],[[0,41,0],[42,52,1]]],[false,[72,71,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,2]]],[false,[4294967295,125],[[0,16,0],[17,17,1],[18,52,0]]],[false,[30,36,28,126,4294967295],[[0,0,0],[1,1,1],[2,19,2],[20,20,3],[21,36,2],[37,39,4],[40,41,2],[42,52,4]]],[false,[75,104,63,4294967295],[[0,8,0],[9,9,1],[10,36,0],[37,38,2],[39,41,0],[42,52,3]]],[false,[103,105,75,104,127,63,4294967295],[[0,0,0],[1,1,1],[2,8,2],[9,9,3],[10,33,2],[34,34,4],[35,36,2],[37,39,5],[40,41,2],[42,52,6]]],[false,[128,105,75,129,63,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,8,1],[9,9,3],[10,36,1],[37,38,4],[39,41,1],[42,52,5]]],[false,[83,45,40,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,36,1],[37,38,3],[39,41,1],[42,52,3]]],[false,[79,68,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,2]]],[false,[81,71,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,2]]],[false,[82,110,63,4294967295],[[0,8,0],[9,9,1],[10,36,0],[37,38,2],[39,41,0],[42,52,3]]],[false,[109,111,82,110,130,63,4294967295],[[0,0,0],[1,1,1],[2,8,2],[9,9,3],[10,33,2],[34,34,4],[35,36,2],[37,39,5],[40,41,2],[42,52,6]]],[false,[131,111,82,132,63,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,8,1],[9,9,3],[10,36,1],[37,38,4],[39,41,1],[42,52,5]]],[false,[84,133,113,112,115,114,4294967295],[[0,6,0],[7,7,1],[8,31,0],[32,32,2],[33,33,3],[34,36,0],[37,38,4],[39,39,0],[40,40,5],[41,41,0],[42,52,6]]],[false,[134,113,84,135,4294967295],[[0,0,0],[1,31,1],[32,32,2],[33,36,1],[37,38,3],[39,41,1],[42,52,4]]],[false,[136,114,137,84,4294967295],[[0,0,0],[1,36,1],[37,38,2],[39,39,1],[40,40,3],[41,41,1],[42,52,4]]],[false,[115,4294967295,135,138,137],[[0,6,0],[7,7,1],[8,31,0],[32,32,2],[33,33,3],[34,39,0],[40,40,4],[41,41,0],[42,52,1]]],[false,[86,116,139,63,4294967295],[[0,8,0],[9,9,1],[10,33,0],[34,34,2],[35,36,0],[37,38,3],[39,41,0],[42,52,4]]],[false,[87,63,117,51,4294967295],[[0,6,0],[7,7,1],[8,8,0],[9,9,2],[10,33,0],[34,34,3],[35,35,1],[36,41,0],[42,52,4]]],[false,[4294967295,140],[[0,22,0],[23,23,1],[24,52,0]]],[true],[false,[4294967295,141],[[0,15,0],[16,16,1],[17,52,0]]],[false,[4294967295,142],[[0,17,0],[18,18,1],[19,52,0]]],[false,[4294967295,143],[[0,29,0],[30,30,1],[31,52,0]]],[false,[4294967295,144],[[0,14,0],[15,15,1],[16,52,0]]],[true],[false,[4294967295,145],[[0,13,0],[14,14,1],[15,52,0]]],[false,[30,36,28,4294967295],[[0,0,0],[1,1,1],[2,36,2],[37,39,3],[40,41,2],[42,52,3]]],[false,[30,36,28,4294967295],[[0,0,0],[1,1,1],[2,36,2],[37,39,3],[40,41,2],[42,52,3]]],[false,[105,129,63,4294967295],[[0,8,0],[9,9,1],[10,36,0],[37,38,2],[39,41,0],[42,52,3]]],[false,[128,105,75,129,146,63,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,8,1],[9,9,3],[10,33,1],[34,34,4],[35,36,1],[37,38,5],[39,41,1],[42,52,6]]],[false,[42,45,40,4294967295],[[0,0,0],[1,1,1],[2,36,2],[37,39,3],[40,41,2],[42,52,3]]],[false,[111,132,63,4294967295],[[0,8,0],[9,9,1],[10,36,0],[37,38,2],[39,41,0],[42,52,3]]],[false,[131,111,82,132,147,63,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,8,1],[9,9,3],[10,33,1],[34,34,4],[35,36,1],[37,38,5],[39,41,1],[42,52,6]]],[false,[48,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,1]]],[false,[113,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,1]]],[false,[148,135,115,4294967295],[[0,0,0],[1,31,1],[32,32,2],[33,41,1],[42,52,3]]],[false,[114,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,1]]],[false,[149,137,115,4294967295],[[0,0,0],[1,39,1],[40,40,2],[41,41,1],[42,52,3]]],[false,[115,150,135,138,137,4294967295],[[0,6,0],[7,7,1],[8,31,0],[32,32,2],[33,33,3],[34,39,0],[40,40,4],[41,41,0],[42,52,5]]],[false,[48,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,1]]],[true],[false,[4294967295,151],[[0,22,0],[23,23,1],[24,52,0]]],[false,[4294967295,152],[[0,27,0],[28,28,1],[29,52,0]]],[false,[4294967295,153],[[0,22,0],[23,23,1],[24,52,0]]],[true],[false,[4294967295,154],[[0,7,0],[8,8,1],[9,52,0]]],[false,[76,36,28,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,36,1],[37,38,3],[39,41,1],[42,52,3]]],[false,[83,45,40,4294967295],[[0,0,0],[1,1,1],[2,2,2],[3,36,1],[37,38,3],[39,41,1],[42,52,3]]],[false,[135,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,1]]],[false,[137,4294967295],[[0,36,0],[37,38,1],[39,41,0],[42,52,1]]],[true],[true],[false,[4294967295,155],[[0,27,0],[28,28,1],[29,52,0]]],[true],[false,[4294967295,156],[[0,7,0],[8,8,1],[9,52,0]]],[false,[4294967295,157],[[0,23,0],[24,24,1],[25,52,0]]],[true],[false,[4294967295,158],[[0,14,0],[15,15,1],[16,52,0]]],[true]]
;_finalTable = 
{"130":22,"133":35,"134":36,"136":36,"139":22,"140":0,"14":5,"15":10,"16":8,"18":16,"147":22,"20":11,"150":35,"151":1,"144":7,"25":21,"146":22,"19":9,"156":27,"29":29,"158":2,"31":29,"32":25,"33":33,"34":33,"35":29,"28":29,"37":19,"38":26,"39":31,"40":30,"41":30,"153":3,"43":30,"44":30,"46":32,"47":36,"48":36,"49":36,"50":36,"51":14,"52":12,"53":13,"54":14,"55":4,"24":20,"64":23,"65":17,"66":28,"74":29,"75":29,"26":21,"27":18,"82":30,"84":36,"85":34,"86":36,"87":14,"93":6,"77":28,"95":28,"97":28,"102":29,"104":29,"106":28,"110":30,"112":36,"113":36,"114":36,"116":36,"117":14,"119":15,"124":22,"126":24,"127":22}
;_inputTable = 
[[0,8,3],[9,9,39],[10,10,37],[11,12,3],[13,13,38],[14,31,3],[32,32,39],[33,33,3],[34,34,32],[35,36,3],[37,37,33],[38,38,3],[39,39,40],[40,41,3],[42,42,9],[43,44,3],[45,45,5],[46,46,4],[47,47,34],[48,57,6],[58,58,41],[59,59,36],[60,60,10],[61,61,3],[62,62,8],[63,64,3],[65,68,13],[69,69,22],[70,70,14],[71,78,13],[79,79,17],[80,90,13],[91,91,1],[92,92,0],[93,93,2],[94,94,3],[95,95,11],[96,96,3],[97,97,18],[98,98,13],[99,99,15],[100,100,13],[101,101,26],[102,102,21],[103,103,19],[104,104,16],[105,105,25],[106,107,13],[108,108,31],[109,109,13],[110,110,29],[111,111,24],[112,112,27],[113,113,13],[114,114,30],[115,115,28],[116,116,23],[117,119,13],[120,120,20],[121,122,13],[123,123,35],[124,124,12],[125,125,7],[126,65535,3]]
;_initialTable = 
{"RULE_PATTERN":11,"DEC":8,"INITIAL":9,"DEC_COND":7,"RULE_INDENT":2,"RULE":6,"GRAMMAR_RULE":10,"GRAMMAR_ACTION":1,"RULE_COND":5,"RULE_TRIAL":3,"RULE_SPACE":4}
;
        }
        
        public function yyrestart(src:String=null):void
        {
            if(src != null)
            {
                _source = src;
            }
            _ended = false;
            _start = 0;
            _oldStart = 0;
            _line = 1;
            _col = 0;
            _advanced = true;
            _tokenName = null;
            _yy = {};
            initialState = "INITIAL";
            ;

        }
        
        public function set source(src:String):void
        {
            _source = src;
            yyrestart();
        }
        
        public function get token():String
        {
            if(_advanced)
            {
                _tokenName = next();
                _advanced = false;
            }
            return _tokenName;
        }
        
        public function advance():void
        {
            _advanced = true;
        }
        
        public function get startIdx():uint
        {
            return _oldStart;
        }
        
        public function get endIdx():uint
        {
            return _start;
        }
        
        public function get position():Array
        {
            return [_line,_col];
        }
        
        public function get positionInfo():String
        {
            return token + '@row:' + position.join('col:');   
        }
        
        public function get yytext():*
        {
            return _yytext;
        }
        
        public function get yyleng():uint
        {
            return endIdx - startIdx;
        }
        
        public function set yytext(value:*):void
        {
            _yytext = value;
        }
        
        public function get yy():Object
        {
            return _yy;
        }

        public function get tokenName():String
        {
            return _tokenName;
        }
        
        protected function next():String
        {
            var _findex:*;
            var _nextState:*;
            var _char:Number;
            var _begin:uint;
            var _next:uint;
            var _ochar:uint;
            var _curState:uint;
            
            while(true)
            {
                _findex = null;
                _nextState = null;
                _char = 0;
                _begin = _start;
                _next = _start;
                _ochar = uint.MAX_VALUE;
                _curState = _transTable[0][1][_initialInput];
                while(true)
                {
                    _char = _source.charCodeAt(_next);
                    /** 计算行,列位置 **/
                    if(_ochar != uint.MAX_VALUE)
                    {
                        if(_char == 0x0d)//\r
                        {
                            _col = 0;
                            _line ++;
                        }
                        else if(_char == 0x0a)//\n
                        {
                            if(_ochar != 0x0d)// != \r
                            {
                                _col = 0;
                                _line ++;
                            }
                        }
                        else
                        {
                            _col ++;
                        }
                    }
                    _ochar = _char;
                    /** 计算行,列位置--结束 **/
                    _nextState = trans(_curState, _char);
                    if(_nextState == DEADSTATE)
                    {
                        if(_begin == _next)
                        {
                            if(_start == _source.length)
                            {
                                if(_ended == false)
                                {
                                    _ended = true;
                                    return "<$>";
                                }
                                else
                                {
                                    throw new Error("已经到达末尾.");
                                }                    
                            }
                            throw new Error("意外的字符,line:" + position.join(",col:") + 'of ' + _source.substr(_begin,20));
                        }
                        else
                        {
                            _findex = _finalTable[_curState];
                            if(_findex == null)
                            {
                                throw new Error("出错,line:" + position.join(",col:"));
                            }
                            _start = _next;
                            _oldStart = _begin;
                            _yytext = _source.substring(startIdx, endIdx);
                            switch(_findex)
{
case 0x0:
    return 'grammar_dec_left';;
    break;
case 0x1:
    return 'grammar_dec_right';;
    break;
case 0x2:
    return 'grammar_dec_nonassoc';;
    break;
case 0x3:
    return 'grammar_dec_start';;
    break;
case 0x4:
    this.begin("GRAMMAR_RULE"); return 'grammar_rule_begin';;
    break;
case 0x5:
    return 'grammar_id';;
    break;
case 0x6:
    yytext = yytext.substr(1, yyleng - 2); return 'grammar_string';;
    break;
case 0x7:
    return 'grammar_dec_prec';;
    break;
case 0x8:
    return ':';;
    break;
case 0x9:
    return ';';;
    break;
case 0xA:
    return '|';;
    break;
case 0xB:
    yy.depth = 0; this.begin("GRAMMAR_ACTION"); return '{';;
    break;
case 0xC:
    yy.depth ++; return '{';;
    break;
case 0xD:
    yy.depth == 0 ? this.begin('GRAMMAR_RULE') : yy.depth --; return '}';;
    break;
case 0xE:
    return 'grammar_action_body';;
    break;
case 0xF:
    this.begin("DEC"); return 'lex_begin';;
    break;
case 0x11:
    this.begin("DEC_COND"); return 'dec_head';;
    break;
case 0x12:
    return 'name';;
    break;
case 0x13:
    return 'name';;
    break;
case 0x14:
    /* skip */;
    break;
case 0x15:
    this.begin('DEC');;
    break;
case 0x16:
    return 'comment';;
    break;
case 0x17:
    this.begin('RULE'); return 'rule_start';;
    break;
case 0x18:
    this.begin('INITIAL'); return 'lex_end';;
    break;
case 0x19:
    this.begin('RULE_COND'); return 'lb';;
    break;
case 0x1A:
    this.begin('RULE_PATTERN'); return 'rb';;
    break;
case 0x1B:
    this.begin('RULE_SPACE'); return 'pattern';;
    break;
case 0x1C:
    this.begin('RULE_SPACE'); yytext = yytext.substr(1, yytext.length - 2); yytext = yytext.replace(/\\(.)/g,"$1"); yytext = yytext.replace(/[\\\*\|\?\+\[\]\(\)\^\.\-\{\}]/g,"\\$&"); return 'pattern';;
    break;
case 0x1D:
    /**begin without < **/this.begin('RULE_SPACE'); return 'pattern';;
    break;
case 0x1E:
    this.begin('RULE_SPACE'); return 'pattern';;
    break;
case 0x1F:
    this.begin('RULE_INDENT');;
    break;
case 0x20:
    /** skip **/;
    break;
case 0x21:
    this.begin('RULE');;
    break;
case 0x22:
    this.begin('RULE_TRIAL'); yytext = yytext.substr(1, yytext.length - 2); return 'action';;
    break;
case 0x23:
    /* support %} in literal string, but in comment is not support yet */this.begin('RULE_TRIAL'); yytext = yytext.substr(2, yytext.length - 4); return 'action';;
    break;
case 0x24:
    this.begin('RULE_TRIAL'); return 'action';;
    break;
}
                            break;
                        }
                    }
                    else
                    {
                        _next += 1;
                        _curState = _nextState;
                    }
                }
            }
            return "";//这里的值会影响返回值!!
        }
        protected function trans(curState:uint,char:Number):uint
        {
            if(isNaN(char))
                return DEADSTATE;
            if(char < _inputTable[0][0] || char > _inputTable[_inputTable.length - 1][1])
                throw new Error("输入超出有效范围,line:" + position.join(",col:"));
            if(_transTable[curState][0] == true)
                return DEADSTATE;

            var ipt:int = find(char,_inputTable);
            var ipt2:int = find(ipt, _transTable[curState][2]);
            return _transTable[curState][1][ipt2];
        }
        
        protected function find(code:uint,seg:Array):uint
        {
            var min:uint;
            var max:uint;
            var mid:uint;
            min = 0;
            max = seg.length - 1;
            while(true)
            {
                mid = (min + max) >>> 1;
                if(seg[mid][0] <= code && seg[mid][1] >= code)
                {
                    return seg[mid][2];
                }
                else if(seg[mid][0] > code)
                {
                    max = mid - 1;
                }
                else
                {
                    min = mid + 1;
                }
            }
            return 0;
        }
        
        protected function begin(state:String=null):void
        {
            if(state == null)
            {
                initialState = "INITIAL";
                return;
            }
            initialState = state;
        }
        
        protected function get initialState():String
        {
            return _initialState;
        }

        protected function set initialState(value:String):void
        {
            if(_initialTable[value] === undefined)
            {
                throw new Error("未定义的起始状态:" + value);
            }
            _initialState = value;
            _initialInput = _initialTable[value];
        }
    }
}